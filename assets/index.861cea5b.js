import{f as a,u as e,s as t,g as n,r as l,i,c as u,F as s,a as r,w as p,v as o,j as d,p as y,l as c,o as v,m as b,t as m}from"./vendor.967f8ea1.js";import{C as w,a as f,N as g}from"./nft.61b44095.js";import{W as h,J as T}from"./web3-provider.5a13caa5.js";var _=[{inputs:[{internalType:"address",name:"rAddr",type:"address"},{internalType:"address",name:"gAddr",type:"address"},{internalType:"address",name:"aAddr",type:"address"},{internalType:"address",name:"cAddr",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"},{internalType:"uint256",name:"class",type:"uint256"},{internalType:"uint32",name:"_str",type:"uint32"},{internalType:"uint32",name:"_dex",type:"uint32"},{internalType:"uint32",name:"_const",type:"uint32"},{internalType:"uint32",name:"_int",type:"uint32"},{internalType:"uint32",name:"_wis",type:"uint32"},{internalType:"uint32",name:"_cha",type:"uint32"}],name:"pointBuy",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"increaseStrength",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"increaseDexterity",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"increaseConstitution",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"increaseIntelligence",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"increaseWisdom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"increaseCharisma",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"adventure",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"attackCellar",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"levelUp",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"claim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"approveBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"adventureAndAttackDungeon",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_ids",type:"uint256[]"}],name:"levelUpAndClaim",outputs:[],stateMutability:"nonpayable",type:"function"}],C={};y("data-v-3616a17e");const k={class:"container"},M={key:0,class:"module-approve"},A=d("p",null,"请授权 Rarity 合约后联系大聪明客服，开启躺赢模式",-1),O=b(" Approve "),S={key:1},j=d("p",null,"已经完成授权",-1),N=b(" Approved "),U=b("Cancel Approve"),B={key:1,class:"module-log"},x=d("h4",null,"批量操作，单次建议不超过30个。否则区块打包缓慢",-1),I=d("p",null,"rarity-game.netlify.app 不兼容, 因为对方的代码设计问题，会导致授权后无法查看",-1),D={class:"action-group"},J=b("批量授权 (加点/领金需要)"),$=b("批量冒险"),F=b("批量地牢"),z=b("批量升级"),H=b("批量领金"),R={class:"action-group"},W=b("批量加点"),E=b(' 1. Barbarian "野蛮人" '),P=d("br",null,null,-1),q=b(' 2. Bard "诗人" '),G=d("br",null,null,-1),K=b(' 3. Cleric "牧师" '),L=d("br",null,null,-1),Q=b(' 4. Druid "德鲁伊" '),V=d("br",null,null,-1),X=b(' 5. Fighter "战士" '),Y=d("br",null,null,-1),Z=b(' 6. Monk "僧侣" '),aa=d("br",null,null,-1),ea=b(' 7. Paladin "圣骑士" '),ta=d("br",null,null,-1),na=b(' 8. Ranger "游侠" '),la=d("br",null,null,-1),ia=b(' 9. Rogue "盗贼" '),ua=d("br",null,null,-1),sa=b(' 10. Sorcerer "巫师" '),ra=d("br",null,null,-1),pa=b(' 11. Wizard "法师" '),oa=d("br",null,null,-1);c();const da={props:{address:String,nftContract:Object,provider:Object},setup(y){const c=y,C=a(""),da=a(""),ya=a(""),ca=a(""),va=a(""),ba=a(""),ma=a(""),wa=a(""),fa=a(""),ga=a(!1),ha=a(!1),Ta=a(),_a=a(),Ca=a({account:!1,approve:!1,action:!1}),ka=e();t((()=>c.address),(a=>{Ma()})),n((()=>{c.address&&Ma()}));const Ma=async()=>{const a=await c.provider.getSigner();Ta.value=new w(f.NFT,g,a);try{Ca.value.approve=!0;const a=await Ta.value.isApprovedForAll(c.address,f.BATCH);ha.value=a,Ca.value.approve=!1}catch(e){ka.error(e.toString())}},Aa=async()=>{const a=window.ethereum?new h(window.ethereum):new T("https://mainnet.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161"),e=await a.getSigner();return _a.value||(_a.value=new w(f.BATCH,_,e)),_a.value},Oa=()=>{const a=C.value.split("\n").map((a=>a.toString()));if(a.every((a=>!isNaN(parseInt(a)))))return a;throw new Error("英雄ID不正确")},Sa=async()=>{ga.value=!0,fa.value="冒险中...";try{const a=await Aa(),e=Oa(),t=await a.adventure(e);await t.wait(),fa.value=`${e.join(", ")} 冒险完成`}catch(a){ka.error(JSON.stringify(a)),fa.value="冒险失败，请重试"}ga.value=!1},ja=async()=>{ga.value=!0,fa.value="攻击地牢中...";try{const a=await Aa(),e=Oa(),t=await a.attackCellar(e);await t.wait(),fa.value=`${e.join(", ")} 攻击地牢完成`}catch(a){ka.error(JSON.stringify(a)),fa.value="攻击地牢失败，请重试"}ga.value=!1},Na=async()=>{ga.value=!0,fa.value="授权中...";try{const a=await Aa(),e=Oa(),t=await a.approveBatch(e);await t.wait(),fa.value=`${e.join(", ")} 授权完成`}catch(a){ka.error(JSON.stringify(a)),fa.value="授权失败，请重试"}ga.value=!1},Ua=async()=>{ga.value=!0,fa.value="升级中...";try{const a=await Aa(),e=Oa(),t=await a.levelUp(e);await t.wait(),fa.value=`${e.join(", ")} 升级完成`}catch(a){ka.error(JSON.stringify(a)),fa.value="升级失败，请重试"}ga.value=!1},Ba=async()=>{ga.value=!0,fa.value="领金中...";try{const a=await Aa(),e=Oa(),t=await a.claim(e);await t.wait(),fa.value=`${e.join(", ")} 领金完成`}catch(a){ka.error(JSON.stringify(a)),fa.value="领金失败，请重试，是否已授权？"}ga.value=!1},xa=async()=>{ga.value=!0,fa.value="设置属性中...";try{const a=await Aa(),e=Oa(),[t,n,l,i,u,s]=(()=>{const a=[da.value,ya.value,ca.value,va.value,ba.value,ma.value];if(a.every((a=>!isNaN(parseInt(a)))))return a;throw new Error("英雄ID不正确")})(),r=await a.pointBuy(e,wa.value,t,n,l,i,u,s);await r.wait(),fa.value=`${e.join(", ")} 设置属性完成`}catch(a){ka.error(JSON.stringify(a)),fa.value="设置属性失败，请重试，是否已授权？"}ga.value=!1};return(a,e)=>{const t=l("n-spin"),n=l("n-button"),c=l("n-input"),w=l("n-tooltip"),g=l("n-text");return v(),i("div",k,[y.address?(v(),i("div",M,[Ca.value.approve?(v(),u(t,{key:0,stroke:"#000"})):(v(),i(s,{key:1},[ha.value?o("",!0):(v(),i(s,{key:0},[A,r(n,{class:"btn-approve",loading:Ca.value.action,size:"large",color:"#000",onClick:e[0]||(e[0]=a=>(async a=>{try{Ca.value.action=!0;const e=await Ta.value.setApprovalForAll(f.BATCH,a);await e.wait(),Ca.value.action=!1,ka.success("授权成功"),await Ma()}catch(e){ka.error(e.toString)}})(!0))},{default:p((()=>[O])),_:1},8,["loading"])],64)),ha.value?(v(),i("div",S,[j,d("div",null,[r(n,{class:"btn-approve",ghost:"",size:"large",color:"#000",disabled:""},{default:p((()=>[N])),_:1}),r(n,{size:"large",onClick:e[1]||(e[1]=e=>a.unapprove(!1))},{default:p((()=>[U])),_:1})])])):o("",!0)],64))])):o("",!0),y.address&&ha.value?(v(),i("div",B,[x,I,d("div",D,[r(n,{class:"action-button",type:"primary",onClick:Na,disabled:ga.value},{default:p((()=>[J])),_:1},8,["disabled"]),r(n,{class:"action-button",type:"primary",onClick:Sa,disabled:ga.value},{default:p((()=>[$])),_:1},8,["disabled"]),r(n,{class:"action-button",type:"primary",onClick:ja,disabled:ga.value},{default:p((()=>[F])),_:1},8,["disabled"]),r(n,{class:"action-button",type:"primary",onClick:Ua,disabled:ga.value},{default:p((()=>[z])),_:1},8,["disabled"]),r(n,{class:"action-button",type:"primary",onClick:Ba,disabled:ga.value},{default:p((()=>[H])),_:1},8,["disabled"])]),d("div",R,[r(n,{class:"action-button",type:"primary",onClick:xa,disabled:ga.value},{default:p((()=>[W])),_:1},8,["disabled"]),r(w,{trigger:"hover"},{trigger:p((()=>[r(c,{class:"action-button",value:wa.value,"onUpdate:value":e[2]||(e[2]=a=>wa.value=a),placeholder:"英雄类型 ID",disabled:ga.value},null,8,["value","disabled"])])),default:p((()=>[E,P,q,G,K,L,Q,V,X,Y,Z,aa,ea,ta,na,la,ia,ua,sa,ra,pa,oa])),_:1}),r(c,{class:"action-button",value:da.value,"onUpdate:value":e[3]||(e[3]=a=>da.value=a),placeholder:"strength",disabled:ga.value},null,8,["value","disabled"]),r(c,{class:"action-button",value:ya.value,"onUpdate:value":e[4]||(e[4]=a=>ya.value=a),placeholder:"dexterity",disabled:ga.value},null,8,["value","disabled"]),r(c,{class:"action-button",value:ca.value,"onUpdate:value":e[5]||(e[5]=a=>ca.value=a),placeholder:"constitution",disabled:ga.value},null,8,["value","disabled"]),r(c,{class:"action-button",value:va.value,"onUpdate:value":e[6]||(e[6]=a=>va.value=a),placeholder:"intelligence",disabled:ga.value},null,8,["value","disabled"]),r(c,{class:"action-button",value:ba.value,"onUpdate:value":e[7]||(e[7]=a=>ba.value=a),placeholder:"wisdom",disabled:ga.value},null,8,["value","disabled"]),r(c,{class:"action-button",value:ma.value,"onUpdate:value":e[8]||(e[8]=a=>ma.value=a),placeholder:"charisma",disabled:ga.value},null,8,["value","disabled"])]),r(g,{type:"info"},{default:p((()=>[b(m(fa.value),1)])),_:1}),r(c,{value:C.value,"onUpdate:value":e[9]||(e[9]=a=>C.value=a),type:"textarea",placeholder:"英雄ID列表，一行一个",disabled:ga.value},null,8,["value","disabled"])])):o("",!0)])}}};"function"==typeof C&&C(da),da.__scopeId="data-v-3616a17e";export{da as default};
